spring.application.name=uaa

# Basic JPA settings for tests (Testcontainers will provide datasource)
spring.jpa.hibernate.ddl-auto=update
spring.jpa.open-in-view=false
# Ensure JPA creates tables before data.sql runs
spring.jpa.defer-datasource-initialization=true

# Logging
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.security.oauth2.client: DEBUG
logging.level.org.springframework.security.oauth2.server: DEBUG
logging.level.org.springframework.security.web.authentication: DEBUG
logging.level.org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler: DEBUG
logging.level.org.springframework.security.web.DefaultRedirectStrategy: DEBUG
logging.level.org.springframework.security.web.access.intercept=TRACE
logging.level.org.springframework.security.web.access.ExceptionTranslationFilter=TRACE
# Authorization Server issuer (override per env)
app.issuer=http://localhost:8080

# Ensure schema.sql runs to create SAS tables when a DataSource is present
spring.sql.init.mode=always

# Persist HTTP sessions in the database so multiple instances share auth state
spring.session.store-type=jdbc
# Auto-create Spring Session tables on startup (use Flyway in prod later)
spring.session.jdbc.initialize-schema=always
# Session timeout (adjust per policy)
spring.session.timeout=8h
# Optional: periodic cleanup of expired sessions (default is enabled)
# spring.session.jdbc.cleanup-cron=0 * * * * *
management.endpoints.web.exposure.include=*
spring.jpa.show-sql=true
spring.mvc.problemdetails.enabled=true