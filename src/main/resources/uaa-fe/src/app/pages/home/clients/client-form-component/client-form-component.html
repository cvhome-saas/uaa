<nb-card>
  <nb-card-header class="d-flex justify-content-between align-items-center">
    <span>OAuth Client Configuration</span>
    <div>
      <button nbButton outline status="basic" routerLink="/home/clients" class="cancel-button">Cancel</button>
      <button nbButton status="primary" (click)="submit()">Save</button>
    </div>
  </nb-card-header>
  <nb-card-body [formGroup]="form">

    <nb-tabset>

      <!-- ===================== GENERAL TAB ===================== -->
      <nb-tab tabTitle="General">
        <div class="row">
          <div class="col-md-6">
            <label>ID</label>
            <input nbInput fullWidth formControlName="id" />
          </div>
          <div class="col-md-6">
            <label>Client ID</label>
            <input nbInput fullWidth formControlName="clientId" />
          </div>

          <div class="col-md-6">
            <label>Client Name</label>
            <input nbInput fullWidth formControlName="clientName" />
          </div>
        </div>

        <div class="row mt-3">
          <div class="col-md-6">
            <label>Client Issued At</label>
            <input nbInput fullWidth formControlName="clientIdIssuedAt" readonly />
          </div>
        </div>
      </nb-tab>

      <!-- ===================== AUTH TAB ===================== -->
      <nb-tab tabTitle="Authentication">
        <label>Client Authentication Methods</label>
        <nb-select fullWidth placeholder="Select" multiple formControlName="clientAuthenticationMethods">
          <nb-option *ngFor="let method of clientAuthenticationMethodsOptions" [value]="method">{{ method }}</nb-option>
        </nb-select>

        <label class="mt-3">Authorization Grant Types</label>
        <nb-select fullWidth multiple formControlName="authorizationGrantTypes">
          <nb-option *ngFor="let type of authorizationGrantTypesOptions" [value]="type">{{ type }}</nb-option>
        </nb-select>
      </nb-tab>

      <!-- ===================== REDIRECTS TAB ===================== -->
      <nb-tab tabTitle="Redirects">
        <div class="d-flex justify-content-between align-items-center">
          <h4>Redirect URIs</h4>
          <button nbButton ghost (click)="addRedirectUri()">
            <nb-icon icon="plus-outline"></nb-icon>
          </button>
        </div>
        <div formArrayName="redirectUris">
          <div *ngFor="let ctrl of redirectUris.controls; let i = index" [formGroupName]="i" class="row mb-2">
            <div class="col-md-11">
              <input nbInput fullWidth formControlName="value" />
            </div>
            <div class="col-md-1">
              <button nbButton ghost status="danger" (click)="removeRedirectUri(i)" [disabled]="redirectUris.length === 1">
                <nb-icon icon="trash-2-outline"></nb-icon>
              </button>
            </div>
          </div>
        </div>

        <div class="d-flex justify-content-between align-items-center mt-4">
          <h4>Post Logout Redirect URIs</h4>
          <button nbButton ghost (click)="addPostLogoutUri()">
            <nb-icon icon="plus-outline"></nb-icon>
          </button>
        </div>
        <div formArrayName="postLogoutRedirectUris">
          <div *ngFor="let ctrl of postLogoutRedirectUris.controls; let i = index" [formGroupName]="i" class="row mb-2">
            <div class="col-md-11">
              <input nbInput fullWidth formControlName="value" />
            </div>
            <div class="col-md-1">
              <button nbButton ghost status="danger" (click)="removePostLogoutUri(i)" [disabled]="postLogoutRedirectUris.length === 1">
                <nb-icon icon="trash-2-outline"></nb-icon>
              </button>
            </div>
          </div>
        </div>
      </nb-tab>

      <!-- ===================== SCOPES TAB ===================== -->
      <nb-tab tabTitle="Scopes">
        <label>Select Scopes</label>
        <nb-select multiple fullWidth formControlName="scopes">
          <nb-option *ngFor="let scope of scopesOptions" [value]="scope">{{ scope }}</nb-option>
        </nb-select>
      </nb-tab>

      <!-- ===================== SETTINGS TAB ===================== -->
      <nb-tab tabTitle="Client Settings">
        <nb-checkbox formControlName="requireProofKey">Require Proof Key</nb-checkbox>
        <nb-checkbox class="mt-2" formControlName="requireAuthorizationConsent">Authorization Consent Required</nb-checkbox>
      </nb-tab>

      <!-- ===================== TOKEN SETTINGS TAB ===================== -->
      <nb-tab tabTitle="Token Settings">
        <div class="row">
          <div class="col-md-6">
            <label>Access Token TTL</label>
            <input nbInput fullWidth formControlName="accessTokenTimeToLive" />
          </div>

          <div class="col-md-6">
            <label>Refresh Token TTL</label>
            <input nbInput fullWidth formControlName="refreshTokenTimeToLive" />
          </div>
        </div>

        <div class="row mt-3">
          <div class="col-md-6">
            <nb-checkbox formControlName="reuseRefreshTokens">Reuse Refresh Tokens</nb-checkbox>
          </div>
        </div>

        <div class="row mt-3">
          <div class="col-md-6">
            <label>ID Token Algorithm</label>
            <nb-select fullWidth formControlName="idTokenSignatureAlgorithm">
              <nb-option *ngFor="let alg of idTokenSignatureAlgorithmOptions" [value]="alg">{{ alg }}</nb-option>
            </nb-select>
          </div>
        </div>
      </nb-tab>

    </nb-tabset>

  </nb-card-body>
</nb-card>
